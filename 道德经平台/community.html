<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>社区 - 道德经AI互动解读者平台</title>
    <script src="https://cdn.tailwindcss.com/3.3.3"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/auth-module.css">
    <link rel="stylesheet" href="css/components.css">
    <style>
        /* 社区页面特定样式 */
        .post-card {
            transition: all 0.3s ease;
        }
        
        .post-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            font-size: 0.875rem;
            border-radius: 9999px;
            background-color: rgba(0, 0, 0, 0.05);
            color: var(--primary-color);
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            transition: all 0.2s ease;
        }
        
        .tag:hover {
            background-color: var(--primary-color);
            color: white;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .reaction-btn {
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
            display: flex;
            align-items: center;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            transition: all 0.2s ease;
        }
        
        .reaction-btn:hover {
            background-color: rgba(0, 0, 0, 0.05);
            color: var(--primary-color);
        }
        
        .reaction-btn.active {
            color: var(--primary-color);
        }
        
        .tab-nav {
            display: flex;
            border-bottom: 1px solid #e5e7eb;
            margin-bottom: 1.5rem;
        }
        
        .tab-nav button {
            padding: 0.75rem 1rem;
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            font-weight: 500;
            color: #6b7280;
            transition: all 0.2s ease;
        }
        
        .tab-nav button:hover {
            color: var(--primary-color);
        }
        
        .tab-nav button.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .create-post-form {
            background-color: white;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #374151;
        }
        
        .form-input, .form-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 1rem;
            transition: border-color 0.2s ease;
        }
        
        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
        }
        
        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        /* 收藏按钮活跃状态 */
        .reaction-btn.active .fa-bookmark {
            color: #f59e0b;
        }
        
        /* 点赞按钮活跃状态 */
        .reaction-btn.active .fa-thumbs-up {
            color: #3b82f6;
        }
        
        /* 通知样式 */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 24px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(20px);
        }
        
        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .notification.success {
            background-color: #10b981;
        }
        
        .notification.info {
            background-color: #3b82f6;
        }
    /* 草稿箱样式 */
.draft-box {
    position: absolute;
    top: 100%;
    right: 0;
    width: 350px;
    background: white;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 1000;
    margin-top: 8px;
}

.draft-box.hidden {
    display: none;
}

.draft-box-title {
    font-size: 16px;
    font-weight: 600;
    padding: 12px 16px;
    border-bottom: 1px solid #e0e0e0;
    margin: 0;
}

.draft-list {
    max-height: 300px;
    overflow-y: auto;
    padding: 8px 0;
}

.draft-item {
    padding: 12px 16px;
    border-bottom: 1px solid #f5f5f5;
    cursor: pointer;
    transition: background-color 0.2s;
}

.draft-item:hover {
    background-color: #f9f9f9;
}

.draft-item:last-child {
    border-bottom: none;
}

.draft-item-title {
    font-size: 14px;
    font-weight: 500;
    margin-bottom: 4px;
    color: #333;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.draft-item-meta {
    font-size: 12px;
    color: #999;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.draft-item-actions {
    display: flex;
    gap: 8px;
}

.draft-item-delete {
    background: none;
    border: none;
    color: #ff4757;
    cursor: pointer;
    font-size: 12px;
    padding: 2px 6px;
    border-radius: 4px;
    transition: background-color 0.2s;
}

.draft-item-delete:hover {
    background-color: #ffebee;
}

.draft-box-footer {
    padding: 12px 16px;
    border-top: 1px solid #e0e0e0;
    text-align: right;
}

.btn-text {
    background: none;
    border: none;
    color: #666;
    cursor: pointer;
    font-size: 14px;
    padding: 6px 12px;
    border-radius: 4px;
    transition: all 0.2s;
}

.btn-text:hover {
    background-color: #f5f5f5;
    color: #333;
}

/* 无草稿提示 */
    .no-drafts {
        padding: 40px 16px;
        text-align: center;
        color: #999;
        font-size: 14px;
    }

    /* 分享菜单样式 */
    .share-container {
        position: relative;
    }

    .share-dropdown {
        position: absolute;
        bottom: 100%;
        right: 0;
        width: 160px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        padding: 8px 0;
        z-index: 100;
        display: none;
        margin-bottom: 8px;
    }

    .share-container.active .share-dropdown {
        display: block;
    }

    .share-item {
        display: block;
        width: 100%;
        text-align: left;
        padding: 8px 16px;
        background: none;
        border: none;
        cursor: pointer;
        color: #333;
        font-size: 14px;
        transition: background-color 0.2s;
    }

    .share-item:hover {
        background-color: #f5f5f5;
        color: var(--primary-color);
    }

    .share-item i {
        margin-right: 8px;
        width: 16px;
        text-align: center;
    }

    /* 社交平台彩色图标 */
    .share-item[data-action="wechat"] i {
        color: #07C160;
    }

    .share-item[data-action="moments"] i {
        background: conic-gradient(from 0deg, #ff0000, #ffff00, #00ff00, #0000ff, #ff0000);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        color: #42b983; /* 降级颜色 */
    }

    .share-item[data-action="qq"] i {
        color: #12B7F5;
    }

    .share-item[data-action="qzone"] i {
        color: #FECE00;
    }

    .share-item[data-action="copy"] i {
        color: #6366f1;
    }

    .share-item[data-action="feedback"] i {
        color: #0ea5e9;
    }

    .share-item[data-action="report"] i {
        color: #ef4444;
    }

    .share-separator {
        height: 1px;
        background-color: #eee;
        margin: 4px 0;
    }

    /* 关注按钮样式 */
    .follow-btn {
        font-size: 0.75rem;
        line-height: 1rem;
        padding: 3px 10px;
        border: 1px solid var(--primary-color);
        border-radius: 9999px;
        color: #000000;
        background-color: var(--primary-color);
        cursor: pointer;
        transition: all 0.2s ease;
        margin-left: 0.5rem;
        font-weight: 600;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    

    .follow-btn.active {
        background-color: #e5e7eb;
        border-color: #d1d5db;
        color: #6b7280;
    }

    .follow-btn.active:hover {
        background-color: #d1d5db;
        color: #4b5563;
    }

    /* 关注列表样式 */
    .followed-users-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
    }

    .followed-user-card {
        background: white;
        border-radius: 0.5rem;
        padding: 1rem;
        text-align: center;
        border: 1px solid #e5e7eb;
        transition: all 0.2s ease;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .followed-user-card:hover {
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        transform: translateY(-2px);
    }

    .followed-user-avatar {
        width: 64px;
        height: 64px;
        border-radius: 50%;
        margin-bottom: 0.75rem;
        object-fit: cover;
    }

    .followed-user-name {
        font-weight: 600;
        color: #111827;
        margin-bottom: 0.25rem;
    }

    .followed-user-bio {
        font-size: 0.75rem;
        color: #6b7280;
        margin-bottom: 0.75rem;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    </style>
</head>
<body class="bg-light">
    <!-- 导航栏 -->
    <nav id="mainNav" class="fixed w-full top-0 z-50 transition-all duration-300 py-4">
        <div class="container mx-auto px-4 md:px-8 flex justify-between items-center">
            <div class="flex items-center">
                <div class="text-2xl font-bold text-primary mr-2">
                    <i class="fas fa-book-open"></i>
                </div>
                <div class="text-xl font-semibold text-primary">道德经AI解读者</div>
            </div>
            
            <!-- 桌面端导航 -->
            <div class="nav-links hidden md:flex space-x-8">
                <a href="index.html" class="text-primary hover:text-accent transition-colors">首页</a>
                <a href="ai-interpretation.html" class="text-primary hover:text-accent transition-colors">AI解读</a>
                <a href="learning-path.html" class="text-primary hover:text-accent transition-colors">学习路径</a>
                <a href="community.html" class="text-accent font-semibold">共创社区</a>
                <a href="resource-library.html" class="text-primary hover:text-accent transition-colors">资源库</a>
                <a href="about.html" class="text-primary hover:text-accent transition-colors">关于</a>
            </div>
            
            <!-- 登录/注册按钮 -->
            <div id="authButtonsDesktop" class="hidden md:flex space-x-4">
                <button id="loginBtnNav" class="px-4 py-2 btn-secondary rounded-md ink-splash">登录</button>
                <button id="registerBtnNav" class="px-4 py-2 btn-primary rounded-md ink-splash">注册</button>
            </div>

            <!-- 用户信息（登录后显示） -->
            <div id="userProfileDesktop" class="hidden items-center space-x-4">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center">
                        <i class="fas fa-user"></i>
                    </div>
                    <span id="userNameDesktop" class="text-primary font-semibold">用户</span>
                </div>
                <button id="logoutBtnDesktop" class="text-sm text-secondary hover:text-red-500 transition-colors">
                    <i class="fas fa-sign-out-alt mr-1"></i>退出
                </button>
            </div>
            
            <!-- 移动端菜单按钮 -->
            <button id="mobileMenuBtn" class="mobile-menu-btn md:hidden text-primary">
                <i class="fas fa-bars text-xl"></i>
            </button>
        </div>
        
        <!-- 移动端菜单 -->
        <div id="mobileMenu" class="mobile-menu bg-light border-t border-secondary mt-4 hidden">
            <div class="container mx-auto px-4 py-3 flex flex-col space-y-3">
                <a href="index.html" class="text-primary hover:text-accent transition-colors py-2">首页</a>
                <a href="ai-interpretation.html" class="text-primary hover:text-accent transition-colors py-2">AI解读</a>
                <a href="learning-path.html" class="text-primary hover:text-accent transition-colors py-2">学习路径</a>
                <a href="community.html" class="text-accent font-semibold py-2">共创社区</a>
                <a href="resource-library.html" class="text-primary hover:text-accent transition-colors py-2">资源库</a>
                <a href="about.html" class="text-primary hover:text-accent transition-colors py-2">关于</a>
                <div id="authButtonsMobile" class="flex space-x-4 pt-2">
                    <button id="loginBtnMobile" class="flex-1 px-4 py-2 btn-secondary rounded-md ink-splash">登录</button>
                    <button id="registerBtnMobile" class="flex-1 px-4 py-2 btn-primary rounded-md ink-splash">注册</button>
                </div>
                
                <div id="userProfileMobile" class="hidden flex-col space-y-3 pt-2 border-t border-gray-200 mt-2">
                    <div class="flex items-center space-x-3 px-2">
                        <div class="w-10 h-10 rounded-full bg-primary text-white flex items-center justify-center">
                            <i class="fas fa-user text-lg"></i>
                        </div>
                        <span id="userNameMobile" class="text-primary font-semibold">用户</span>
                    </div>
                    <button id="logoutBtnMobile" class="w-full text-left px-2 py-2 text-secondary hover:text-red-500 transition-colors flex items-center">
                        <i class="fas fa-sign-out-alt mr-2"></i>退出登录
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- 主要内容 -->
    <main class="container mx-auto px-4 md:px-8 pt-24 pb-12">
        <!-- 页面标题 -->
        <div class="text-center mb-12">
            <h1 class="text-4xl font-bold text-primary mb-4">道德经社区</h1>
            <p class="text-xl text-dark max-w-3xl mx-auto">
                与同道中人交流心得，分享感悟，共同探索《道德经》的智慧
            </p>
        </div>

        <!-- 社区统计 -->
        <section class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-12">
            <div class="bg-white rounded-lg shadow-md p-6 text-center">
                <div class="text-3xl font-bold text-primary mb-2">1,234</div>
                <div class="text-gray-600">社区成员</div>
            </div>
            <div class="bg-white rounded-lg shadow-md p-6 text-center">
                <div class="text-3xl font-bold text-primary mb-2">567</div>
                <div class="text-gray-600">讨论帖子</div>
            </div>
            <div class="bg-white rounded-lg shadow-md p-6 text-center">
                <div class="text-3xl font-bold text-primary mb-2">2,345</div>
                <div class="text-gray-600">回复评论</div>
            </div>
            <div class="bg-white rounded-lg shadow-md p-6 text-center">
                <div class="text-3xl font-bold text-primary mb-2">89</div>
                <div class="text-gray-600">今日活跃</div>
            </div>
        </section>

        <!-- 创建帖子表单 -->
        <section class="create-post-form">
            <h2 class="text-xl font-bold text-dark mb-4">分享您的想法</h2>
            <form id="createPostForm">
                <div class="form-group">
                    <label for="postTitle" class="form-label">标题</label>
                    <input type="text" id="postTitle" class="form-input" placeholder="请输入帖子标题...">
                </div>
                <div class="form-group">
                    <label for="postContent" class="form-label">内容</label>
                    <textarea id="postContent" class="form-textarea" placeholder="分享您对《道德经》的理解、感悟或问题..."></textarea>
                </div>
                <div class="form-group">
                    <label for="postTags" class="form-label">标签</label>
                    <input type="text" id="postTags" class="form-input" placeholder="添加标签，用空格分隔（如：第八章 上善若水 感悟）">
                </div>
                <div class="flex justify-end">
                    <button type="button" id="saveDraftBtn" class="btn btn-outline mr-2">保存草稿</button>
                    <button type="button" id="draftBoxBtn" class="btn btn-outline mr-2">草稿箱</button>
                    <button type="submit" class="btn btn-primary">发布帖子</button>
                    
                    <!-- 草稿箱下拉菜单 -->
                    <div id="draftBox" class="draft-box hidden">
                        <h3 class="draft-box-title">我的草稿</h3>
                        <div id="draftList" class="draft-list">
                            <!-- 草稿列表将通过JavaScript动态生成 -->
                        </div>
                        <div class="draft-box-footer">
                            <button id="clearAllDrafts" class="btn-text">
                                <i class="far fa-trash-alt mr-1"></i>
                                清空草稿箱
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </section>

        <!-- 搜索栏 -->
        <section class="mb-8">
            <div class="relative">
                <input type="text" id="searchInput" class="w-full pl-10 pr-24 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent shadow-sm transition-all" placeholder="搜索帖子标题、内容或标签...">
                <div class="absolute left-0 top-0 pl-3 flex items-center h-full text-gray-400">
                    <i class="fas fa-search"></i>
                </div>
                <button id="searchBtn" class="absolute right-0 top-0 h-full px-6 bg-primary text-white rounded-r-lg hover:bg-opacity-90 transition-colors font-medium">
                    搜索
                </button>
            </div>
        </section>

        <!-- 标签导航 -->
        <section class="mb-8">
            <div class="tab-nav">
                <button class="active" data-tab="latest">最新发布</button>
                <button data-tab="popular">热门讨论</button>
                <button data-tab="following">关注的人</button>
                <button data-tab="favorites">我的收藏</button>
                <button data-tab="unanswered">待解答</button>
            </div>
        </section>

        <!-- 帖子列表 -->
        <section>
            <!-- 最新发布 -->
            <div id="latest" class="tab-content active">
                <div class="space-y-6">
                    <!-- 帖子1 -->
                    <article class="post-card bg-white rounded-lg shadow-md p-6">
                        <div class="flex items-start mb-4">
                            <img src="https://picsum.photos/id/1/40/40" alt="用户头像" class="user-avatar mr-3">
                            <div class="flex-1">
                                <div class="flex items-center mb-1">
                                    <h3 class="font-medium text-dark mr-2">张明</h3>
                                    <button class="follow-btn" data-username="张明">
                                        <span>+ 关注</span>
                                    </button>
                                    <span class="text-sm text-gray-500">2小时前</span>
                                </div>
                                <h2 class="text-xl font-bold text-dark mb-2">对"上善若水"的现代理解</h2>
                                <p class="text-gray-700 mb-4">
                                    最近在研读《道德经》第八章"上善若水"，深有感触。老子以水喻道，认为水的特性最接近于"道"的本质。在现代社会中，我们如何理解和实践这种"上善若水"的智慧呢？
                                </p>
                                <div class="mb-4">
                                    <span class="tag">#第八章</span>
                                    <span class="tag">#上善若水</span>
                                    <span class="tag">#现代应用</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-4">
                                        <button class="reaction-btn">
                                            <i class="far fa-thumbs-up mr-1"></i>
                                            <span>23</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-comment mr-1"></i>
                                            <span>15</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-bookmark mr-1"></i>
                                            <span>收藏</span>
                                        </button>
                                    </div>
                                    <div class="share-container">
                                        <button class="reaction-btn share-btn">
                                            <i class="fas fa-share mr-1"></i>
                                            <span>分享</span>
                                        </button>
                                        <div class="share-dropdown">
                                            <button class="share-item" data-action="wechat">
                                                <i class="fab fa-weixin"></i> 微信
                                            </button>
                                            <button class="share-item" data-action="moments">
                                                <i class="fas fa-circle-notch"></i> 朋友圈
                                            </button>
                                            <button class="share-item" data-action="qq">
                                                <i class="fab fa-qq"></i> QQ
                                            </button>
                                            <button class="share-item" data-action="qzone">
                                                <i class="fas fa-star"></i> QQ空间
                                            </button>
                                            <div class="share-separator"></div>
                                            <button class="share-item" data-action="copy">
                                                <i class="fas fa-link"></i> 复制链接
                                            </button>
                                            <button class="share-item" data-action="feedback">
                                                <i class="fas fa-comment-alt"></i> 内容反馈
                                            </button>
                                            <button class="share-item" data-action="report">
                                                <i class="fas fa-exclamation-circle"></i> 举报
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>

                    <!-- 帖子2 -->
                    <article class="post-card bg-white rounded-lg shadow-md p-6">
                        <div class="flex items-start mb-4">
                            <img src="https://picsum.photos/id/2/40/40" alt="用户头像" class="user-avatar mr-3">
                            <div class="flex-1">
                                <div class="flex items-center mb-1">
                                    <h3 class="font-medium text-dark mr-2">李静</h3>
                                    <button class="follow-btn" data-username="李静">
                                        <span>+ 关注</span>
                                    </button>
                                    <span class="text-sm text-gray-500">5小时前</span>
                                </div>
                                <h2 class="text-xl font-bold text-dark mb-2">《道德经》与心理健康的联系</h2>
                                <p class="text-gray-700 mb-4">
                                    作为一名心理咨询师，我发现《道德经》中的许多理念与现代心理健康理论不谋而合。"无为而治"对应着正念中的"不评判"，"知足常乐"与积极心理学中的"感恩练习"相似。大家如何看待这种古代智慧与现代科学的契合？
                                </p>
                                <div class="mb-4">
                                    <span class="tag">#心理健康</span>
                                    <span class="tag">#无为</span>
                                    <span class="tag">#现代应用</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-4">
                                        <button class="reaction-btn">
                                            <i class="far fa-thumbs-up mr-1"></i>
                                            <span>45</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-comment mr-1"></i>
                                            <span>28</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-bookmark mr-1"></i>
                                            <span>收藏</span>
                                        </button>
                                    </div>
                                    <div class="share-container">
                                        <button class="reaction-btn share-btn">
                                            <i class="fas fa-share mr-1"></i>
                                            <span>分享</span>
                                        </button>
                                        <div class="share-dropdown">
                                            <button class="share-item" data-action="wechat">
                                                <i class="fab fa-weixin"></i> 微信
                                            </button>
                                            <button class="share-item" data-action="moments">
                                                <i class="fas fa-circle-notch"></i> 朋友圈
                                            </button>
                                            <button class="share-item" data-action="qq">
                                                <i class="fab fa-qq"></i> QQ
                                            </button>
                                            <button class="share-item" data-action="qzone">
                                                <i class="fas fa-star"></i> QQ空间
                                            </button>
                                            <div class="share-separator"></div>
                                            <button class="share-item" data-action="copy">
                                                <i class="fas fa-link"></i> 复制链接
                                            </button>
                                            <button class="share-item" data-action="feedback">
                                                <i class="fas fa-comment-alt"></i> 内容反馈
                                            </button>
                                            <button class="share-item" data-action="report">
                                                <i class="fas fa-exclamation-circle"></i> 举报
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>

                    <!-- 帖子3 -->
                    <article class="post-card bg-white rounded-lg shadow-md p-6">
                        <div class="flex items-start mb-4">
                            <img src="https://picsum.photos/id/3/40/40" alt="用户头像" class="user-avatar mr-3">
                            <div class="flex-1">
                                <div class="flex items-center mb-1">
                                    <h3 class="font-medium text-dark mr-2">王强</h3>
                                    <button class="follow-btn" data-username="王强">
                                        <span>+ 关注</span>
                                    </button>
                                    <span class="text-sm text-gray-500">1天前</span>
                                </div>
                                <h2 class="text-xl font-bold text-dark mb-2">关于"道可道，非常道"的多种解释</h2>
                                <p class="text-gray-700 mb-4">
                                    《道德经》开篇"道可道，非常道；名可名，非常名"有多种解释。有人认为这是说真正的"道"无法用语言表达，有人认为这是在强调语言的局限性。我整理了历代学者的不同解读，想听听大家的看法。
                                </p>
                                <div class="mb-4">
                                    <span class="tag">#第一章</span>
                                    <span class="tag">#道可道</span>
                                    <span class="tag">#学术讨论</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-4">
                                        <button class="reaction-btn">
                                            <i class="far fa-thumbs-up mr-1"></i>
                                            <span>67</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-comment mr-1"></i>
                                            <span>42</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-bookmark mr-1"></i>
                                            <span>收藏</span>
                                        </button>
                                    </div>
                                    <div class="share-container">
                                        <button class="reaction-btn share-btn">
                                            <i class="fas fa-share mr-1"></i>
                                            <span>分享</span>
                                        </button>
                                        <div class="share-dropdown">
                                            <button class="share-item" data-action="wechat">
                                                <i class="fab fa-weixin"></i> 微信
                                            </button>
                                            <button class="share-item" data-action="moments">
                                                <i class="fas fa-circle-notch"></i> 朋友圈
                                            </button>
                                            <button class="share-item" data-action="qq">
                                                <i class="fab fa-qq"></i> QQ
                                            </button>
                                            <button class="share-item" data-action="qzone">
                                                <i class="fas fa-star"></i> QQ空间
                                            </button>
                                            <div class="share-separator"></div>
                                            <button class="share-item" data-action="copy">
                                                <i class="fas fa-link"></i> 复制链接
                                            </button>
                                            <button class="share-item" data-action="feedback">
                                                <i class="fas fa-comment-alt"></i> 内容反馈
                                            </button>
                                            <button class="share-item" data-action="report">
                                                <i class="fas fa-exclamation-circle"></i> 举报
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>
                </div>
            </div>

            <!-- 热门讨论 -->
            <div id="popular" class="tab-content">
                <div class="space-y-6">
                    <!-- 热门帖子1 -->
                    <article class="post-card bg-white rounded-lg shadow-md p-6">
                        <div class="flex items-start mb-4">
                            <img src="https://picsum.photos/id/4/40/40" alt="用户头像" class="user-avatar mr-3">
                            <div class="flex-1">
                                <div class="flex items-center mb-1">
                                    <h3 class="font-medium text-dark mr-2">赵敏</h3>
                                    <button class="follow-btn" data-username="赵敏">
                                        <span>+ 关注</span>
                                    </button>
                                    <span class="text-sm text-gray-500">3天前</span>
                                    <span class="ml-2 px-2 py-1 bg-red-100 text-red-600 text-xs rounded-full">热门</span>
                                </div>
                                <h2 class="text-xl font-bold text-dark mb-2">如何将"无为而治"应用到现代企业管理中？</h2>
                                <p class="text-gray-700 mb-4">
                                    作为一个创业者，我一直思考如何将《道德经》中的"无为而治"理念应用到企业管理中。不是放任不管，而是创造一个让员工自发成长的环境。大家有什么实践经验可以分享吗？
                                </p>
                                <div class="mb-4">
                                    <span class="tag">#无为而治</span>
                                    <span class="tag">#企业管理</span>
                                    <span class="tag">#实践应用</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-4">
                                        <button class="reaction-btn">
                                            <i class="far fa-thumbs-up mr-1"></i>
                                            <span>156</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-comment mr-1"></i>
                                            <span>89</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-bookmark mr-1"></i>
                                            <span>收藏</span>
                                        </button>
                                    </div>
                                    <div class="share-container">
                                        <button class="reaction-btn share-btn">
                                            <i class="fas fa-share mr-1"></i>
                                            <span>分享</span>
                                        </button>
                                        <div class="share-dropdown">
                                            <button class="share-item" data-action="wechat">
                                                <i class="fab fa-weixin"></i> 微信
                                            </button>
                                            <button class="share-item" data-action="moments">
                                                <i class="fas fa-circle-notch"></i> 朋友圈
                                            </button>
                                            <button class="share-item" data-action="qq">
                                                <i class="fab fa-qq"></i> QQ
                                            </button>
                                            <button class="share-item" data-action="qzone">
                                                <i class="fas fa-star"></i> QQ空间
                                            </button>
                                            <div class="share-separator"></div>
                                            <button class="share-item" data-action="copy">
                                                <i class="fas fa-link"></i> 复制链接
                                            </button>
                                            <button class="share-item" data-action="feedback">
                                                <i class="fas fa-comment-alt"></i> 内容反馈
                                            </button>
                                            <button class="share-item" data-action="report">
                                                <i class="fas fa-exclamation-circle"></i> 举报
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>

                    <!-- 热门帖子2 -->
                    <article class="post-card bg-white rounded-lg shadow-md p-6">
                        <div class="flex items-start mb-4">
                            <img src="https://picsum.photos/id/5/40/40" alt="用户头像" class="user-avatar mr-3">
                            <div class="flex-1">
                                <div class="flex items-center mb-1">
                                    <h3 class="font-medium text-dark mr-2">陈涛</h3>
                                    <button class="follow-btn" data-username="陈涛">
                                        <span>+ 关注</span>
                                    </button>
                                    <span class="text-sm text-gray-500">5天前</span>
                                    <span class="ml-2 px-2 py-1 bg-red-100 text-red-600 text-xs rounded-full">热门</span>
                                </div>
                                <h2 class="text-xl font-bold text-dark mb-2">《道德经》与环保理念的不谋而合</h2>
                                <p class="text-gray-700 mb-4">
                                    《道德经》中"人法地，地法天，天法道，道法自然"的思想，与现代环保理念高度契合。老子强调顺应自然，减少人为干预，这与当代生态保护理念不谋而合。我们应该如何从《道德经》中汲取环保智慧？
                                </p>
                                <div class="mb-4">
                                    <span class="tag">#环保</span>
                                    <span class="tag">#道法自然</span>
                                    <span class="tag">#生态保护</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-4">
                                        <button class="reaction-btn">
                                            <i class="far fa-thumbs-up mr-1"></i>
                                            <span>128</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-comment mr-1"></i>
                                            <span>76</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-bookmark mr-1"></i>
                                            <span>收藏</span>
                                        </button>
                                    </div>
                                    <div class="share-container">
                                        <button class="reaction-btn share-btn">
                                            <i class="fas fa-share mr-1"></i>
                                            <span>分享</span>
                                        </button>
                                        <div class="share-dropdown">
                                            <button class="share-item" data-action="wechat">
                                                <i class="fab fa-weixin"></i> 微信
                                            </button>
                                            <button class="share-item" data-action="moments">
                                                <i class="fas fa-circle-notch"></i> 朋友圈
                                            </button>
                                            <button class="share-item" data-action="qq">
                                                <i class="fab fa-qq"></i> QQ
                                            </button>
                                            <button class="share-item" data-action="qzone">
                                                <i class="fas fa-star"></i> QQ空间
                                            </button>
                                            <div class="share-separator"></div>
                                            <button class="share-item" data-action="copy">
                                                <i class="fas fa-link"></i> 复制链接
                                            </button>
                                            <button class="share-item" data-action="feedback">
                                                <i class="fas fa-comment-alt"></i> 内容反馈
                                            </button>
                                            <button class="share-item" data-action="report">
                                                <i class="fas fa-exclamation-circle"></i> 举报
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>

                    <!-- 热门帖子3 -->
                    <article class="post-card bg-white rounded-lg shadow-md p-6">
                        <div class="flex items-start mb-4">
                            <img src="https://picsum.photos/id/8/40/40" alt="用户头像" class="user-avatar mr-3">
                            <div class="flex-1">
                                <div class="flex items-center mb-1">
                                    <h3 class="font-medium text-dark mr-2">李明</h3>
                                    <button class="follow-btn" data-username="李明">
                                        <span>+ 关注</span>
                                    </button>
                                    <span class="text-sm text-gray-500">4天前</span>
                                    <span class="ml-2 px-2 py-1 bg-red-100 text-red-600 text-xs rounded-full">热门</span>
                                </div>
                                <h2 class="text-xl font-bold text-dark mb-2">"知足常乐"在消费主义时代的价值</h2>
                                <p class="text-gray-700 mb-4">
                                    在这个物欲横流的时代，我们总是想要更多。老子说"知足之足，常足矣"，这种"知足"的心态是否是抵抗消费主义焦虑的一剂良药？大家是如何平衡欲望与知足的？
                                </p>
                                <div class="mb-4">
                                    <span class="tag">#知足常乐</span>
                                    <span class="tag">#消费主义</span>
                                    <span class="tag">#心态调节</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-4">
                                        <button class="reaction-btn">
                                            <i class="far fa-thumbs-up mr-1"></i>
                                            <span>142</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-comment mr-1"></i>
                                            <span>68</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-bookmark mr-1"></i>
                                            <span>收藏</span>
                                        </button>
                                    </div>
                                    <div class="share-container">
                                        <button class="reaction-btn share-btn">
                                            <i class="fas fa-share mr-1"></i>
                                            <span>分享</span>
                                        </button>
                                        <div class="share-dropdown">
                                            <button class="share-item" data-action="wechat">
                                                <i class="fab fa-weixin"></i> 微信
                                            </button>
                                            <button class="share-item" data-action="moments">
                                                <i class="fas fa-circle-notch"></i> 朋友圈
                                            </button>
                                            <button class="share-item" data-action="qq">
                                                <i class="fab fa-qq"></i> QQ
                                            </button>
                                            <button class="share-item" data-action="qzone">
                                                <i class="fas fa-star"></i> QQ空间
                                            </button>
                                            <div class="share-separator"></div>
                                            <button class="share-item" data-action="copy">
                                                <i class="fas fa-link"></i> 复制链接
                                            </button>
                                            <button class="share-item" data-action="feedback">
                                                <i class="fas fa-comment-alt"></i> 内容反馈
                                            </button>
                                            <button class="share-item" data-action="report">
                                                <i class="fas fa-exclamation-circle"></i> 举报
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>
                </div>
            </div>

            <!-- 关注的人 -->
            <div id="following" class="tab-content">
                <div class="space-y-6">
                    <div class="bg-white rounded-lg shadow-md p-8 text-center">
                        <i class="fas fa-users text-6xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl font-medium text-dark mb-2">您还没有关注任何人</h3>
                        <p class="text-gray-600 mb-6">关注其他用户，查看他们的最新动态</p>
                        <button class="btn btn-primary">发现用户</button>
                    </div>
                </div>
            </div>

            <!-- 我的收藏 -->
            <div id="favorites" class="tab-content">
                <div class="space-y-6">
                    <!-- 收藏内容将通过JavaScript动态加载 -->
                    <div class="text-center py-12">
                        <i class="far fa-bookmark text-4xl text-gray-300 mb-4"></i>
                        <p class="text-gray-500">您还没有收藏任何帖子</p>
                    </div>
                </div>
            </div>

            <!-- 待解答 -->
            <div id="unanswered" class="tab-content">
                <div class="space-y-6">
                    <!-- 待解答帖子1 -->
                    <article class="post-card bg-white rounded-lg shadow-md p-6">
                        <div class="flex items-start mb-4">
                            <img src="https://picsum.photos/id/6/40/40" alt="用户头像" class="user-avatar mr-3">
                            <div class="flex-1">
                                <div class="flex items-center mb-1">
                                    <h3 class="font-medium text-dark mr-2">刘洋</h3>
                                    <button class="follow-btn" data-username="刘洋">
                                        <span>+ 关注</span>
                                    </button>
                                    <span class="text-sm text-gray-500">1天前</span>
                                    <span class="ml-2 px-2 py-1 bg-orange-100 text-orange-600 text-xs rounded-full">待解答</span>
                                </div>
                                <h2 class="text-xl font-bold text-dark mb-2">如何理解"知者不言，言者不知"？</h2>
                                <p class="text-gray-700 mb-4">
                                    《道德经》第五十六章说"知者不言，言者不知"，这是否意味着真正的智者不应该表达自己的见解？这与我们鼓励知识分享的现代价值观是否矛盾？
                                </p>
                                <div class="mb-4">
                                    <span class="tag">#第五十六章</span>
                                    <span class="tag">#知者不言</span>
                                    <span class="tag">#疑问</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-4">
                                        <button class="reaction-btn">
                                            <i class="far fa-thumbs-up mr-1"></i>
                                            <span>12</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-comment mr-1"></i>
                                            <span>3</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-bookmark mr-1"></i>
                                            <span>收藏</span>
                                        </button>
                                    </div>
                                    <div class="share-container">
                                        <button class="reaction-btn share-btn">
                                            <i class="fas fa-share mr-1"></i>
                                            <span>分享</span>
                                        </button>
                                        <div class="share-dropdown">
                                            <button class="share-item" data-action="wechat">
                                                <i class="fab fa-weixin"></i> 微信
                                            </button>
                                            <button class="share-item" data-action="moments">
                                                <i class="fas fa-circle-notch"></i> 朋友圈
                                            </button>
                                            <button class="share-item" data-action="qq">
                                                <i class="fab fa-qq"></i> QQ
                                            </button>
                                            <button class="share-item" data-action="qzone">
                                                <i class="fas fa-star"></i> QQ空间
                                            </button>
                                            <div class="share-separator"></div>
                                            <button class="share-item" data-action="copy">
                                                <i class="fas fa-link"></i> 复制链接
                                            </button>
                                            <button class="share-item" data-action="feedback">
                                                <i class="fas fa-comment-alt"></i> 内容反馈
                                            </button>
                                            <button class="share-item" data-action="report">
                                                <i class="fas fa-exclamation-circle"></i> 举报
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>

                    <!-- 待解答帖子2 -->
                    <article class="post-card bg-white rounded-lg shadow-md p-6">
                        <div class="flex items-start mb-4">
                            <img src="https://picsum.photos/id/7/40/40" alt="用户头像" class="user-avatar mr-3">
                            <div class="flex-1">
                                <div class="flex items-center mb-1">
                                    <h3 class="font-medium text-dark mr-2">周芳</h3>
                                    <button class="follow-btn" data-username="周芳">
                                        <span>+ 关注</span>
                                    </button>
                                    <span class="text-sm text-gray-500">2天前</span>
                                    <span class="ml-2 px-2 py-1 bg-orange-100 text-orange-600 text-xs rounded-full">待解答</span>
                                </div>
                                <h2 class="text-xl font-bold text-dark mb-2">《道德经》中的"小国寡民"思想是否适用于现代社会？</h2>
                                <p class="text-gray-700 mb-4">
                                    《道德经》第八十章描述了"小国寡民"的理想社会，这与现代全球化、城市化趋势是否相悖？我们应该如何理解这种思想在当代的意义？
                                </p>
                                <div class="mb-4">
                                    <span class="tag">#第八十章</span>
                                    <span class="tag">#小国寡民</span>
                                    <span class="tag">#现代社会</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-4">
                                        <button class="reaction-btn">
                                            <i class="far fa-thumbs-up mr-1"></i>
                                            <span>18</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-comment mr-1"></i>
                                            <span>5</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-bookmark mr-1"></i>
                                            <span>收藏</span>
                                        </button>
                                    </div>
                                    <div class="share-container">
                                        <button class="reaction-btn share-btn">
                                            <i class="fas fa-share mr-1"></i>
                                            <span>分享</span>
                                        </button>
                                        <div class="share-dropdown">
                                            <button class="share-item" data-action="wechat">
                                                <i class="fab fa-weixin"></i> 微信
                                            </button>
                                            <button class="share-item" data-action="moments">
                                                <i class="fas fa-circle-notch"></i> 朋友圈
                                            </button>
                                            <button class="share-item" data-action="qq">
                                                <i class="fab fa-qq"></i> QQ
                                            </button>
                                            <button class="share-item" data-action="qzone">
                                                <i class="fas fa-star"></i> QQ空间
                                            </button>
                                            <div class="share-separator"></div>
                                            <button class="share-item" data-action="copy">
                                                <i class="fas fa-link"></i> 复制链接
                                            </button>
                                            <button class="share-item" data-action="feedback">
                                                <i class="fas fa-comment-alt"></i> 内容反馈
                                            </button>
                                            <button class="share-item" data-action="report">
                                                <i class="fas fa-exclamation-circle"></i> 举报
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>
                </div>
            </div>
        </section>

        <!-- 加载更多按钮 -->
        <div class="text-center mt-8">
            <button id="loadMoreBtn" class="btn btn-outline">加载更多</button>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="bg-dark text-white py-8">
        <div class="container mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <div class="flex items-center mb-4">
                        <div class="logo mr-2">
                            <i class="fas fa-book-open"></i>
                        </div>
                        <span class="text-xl font-bold">道德经AI解读者</span>
                    </div>
                    <p class="text-gray-400 mb-4">
                        结合AI技术与传统文化，为您提供智能化的道德经学习体验
                    </p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-weixin text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-weibo text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-github text-xl"></i>
                        </a>
                    </div>
                </div>
                <div>
                    <h4 class="text-lg font-bold mb-4">平台功能</h4>
                    <ul class="space-y-2">
                        <li><a href="ai-interpretation.html" class="text-gray-400 hover:text-white">AI解读</a></li>
                        <li><a href="learning-path.html" class="text-gray-400 hover:text-white">学习路径</a></li>
                        <li><a href="community.html" class="text-gray-400 hover:text-white">社区交流</a></li>
                        <li><a href="resource-library.html" class="text-gray-400 hover:text-white">资源库</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-bold mb-4">学习资源</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white">道德经原文</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">注解版本</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">学习工具</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">研究论文</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-bold mb-4">联系我们</h4>
                    <ul class="space-y-2">
                        <li class="text-gray-400"><i class="fas fa-envelope mr-2"></i>contact@daodejing.ai</li>
                        <li class="text-gray-400"><i class="fas fa-phone mr-2"></i>+86 123 4567 8900</li>
                        <li class="text-gray-400"><i class="fas fa-map-marker-alt mr-2"></i>北京市朝阳区</li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; 2023 道德经AI互动解读者平台. 保留所有权利.</p>
            </div>
        </div>
    </footer>

    <!-- 登录注册模态框 -->
    <div id="authModal" class="auth-modal">
        <div class="auth-modal-content modal-fade">
            <div class="auth-modal-header">
                <h3 id="authTitle" class="text-xl font-semibold">登录</h3>
                <button id="closeAuthModal" class="text-white hover:text-gray-200">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="auth-modal-body">
                <form id="authForm">
                    <div class="mb-4">
                        <label for="email" class="block text-sm font-medium text-dark mb-2">邮箱</label>
                        <input type="email" id="email" name="email" required
                            class="w-full px-3 py-2 border border-secondary rounded-md focus:outline-none focus:ring-2 focus:ring-accent">
                        <div id="emailError" class="error-message text-red-500">请输入有效的邮箱地址</div>
                    </div>
                    
                    <div class="mb-4">
                        <label for="password" class="block text-sm font-medium text-dark mb-2">密码</label>
                        <input type="password" id="password" name="password" required
                            class="w-full px-3 py-2 border border-secondary rounded-md focus:outline-none focus:ring-2 focus:ring-accent">
                        <div id="passwordError" class="error-message text-red-500">密码至少需要6个字符</div>
                    </div>
                    
                    <div id="confirmPasswordDiv" class="mb-4 hidden">
                        <label for="confirmPassword" class="block text-sm font-medium text-dark mb-2">确认密码</label>
                        <input type="password" id="confirmPassword" name="confirmPassword"
                            class="w-full px-3 py-2 border border-secondary rounded-md focus:outline-none focus:ring-2 focus:ring-accent">
                        <div id="confirmPasswordError" class="error-message text-red-500">两次输入的密码不一致</div>
                    </div>
                    
                    <div id="passwordStrengthDiv" class="mb-4 hidden">
                        <div class="flex justify-between mb-1">
                            <span class="text-sm text-dark">密码强度</span>
                            <span id="strengthText" class="text-sm text-dark">弱</span>
                        </div>
                        <div class="strength-bar">
                            <div id="strengthFill" class="strength-fill bg-red-500" style="width: 25%"></div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <button type="submit" id="authSubmitBtn" class="w-full py-2 px-4 btn-primary rounded-md flex justify-center items-center">
                            <span id="authBtnText">登录</span>
                            <div id="authLoadingSpinner" class="loading-spinner ml-2">
                                <i class="fas fa-spinner fa-spin"></i>
                            </div>
                        </button>
                    </div>
                </form>
            </div>
            <div class="auth-modal-footer">
                <div class="text-center text-sm">
                    <span id="authFooterText">还没有账号？</span>
                    <a href="#" id="authToggleLink" class="text-accent hover:underline">立即注册</a>
                </div>
            </div>
        </div>
    </div>

    <!-- 引入JavaScript文件 -->
    <script src="js/main.js"></script>
    <script src="js/auth-module.js"></script>
    <script src="js/scroll-effects.js"></script>
    
    <!-- 社区功能脚本 -->
    <script>
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化时清除收藏状态，确保按钮未被点击
            localStorage.removeItem('communityBookmarks');

            // 初始化导航栏
            if (typeof initNavbar === 'function') {
                initNavbar();
            }
            
            // 初始化认证模块
            if (typeof initAuthModule === 'function') {
                initAuthModule();
            }

            // 初始化收藏功能
            initBookmarkFunctionality();
            
            // 初始化点赞功能
            initLikeFunctionality();
            
            // 初始化标签切换功能
            initTabSwitching();
            
            // 初始化表单功能
            initFormFunctionality();
            
            // 初始化加载更多功能
            initLoadMoreFunctionality();

            // 初始化分享功能
            initShareFunctionality();

            // 初始化关注功能
            initFollowFunctionality();

            // 初始化搜索功能
            initSearchFunctionality();
        });
        
        // 模拟更多帖子数据
        const morePostsData = {
            latest: [
                {
                    user: "周伟",
                    avatarId: 10,
                    time: "6小时前",
                    title: "《道德经》中的养生智慧",
                    content: "老子提倡'致虚极，守静笃'，这对现代人的养生有何启示？我认为保持内心的平静是身体健康的基础，大家怎么看？",
                    tags: ["养生", "致虚极", "身心健康"],
                    likes: 34,
                    comments: 12
                },
                {
                    user: "吴丽",
                    avatarId: 11,
                    time: "8小时前",
                    title: "如何做到'宠辱不惊'？",
                    content: "在职场中经常会遇到被表扬或批评的情况，如何修炼才能真正做到'宠辱不惊'？《道德经》第十三章给了我们很好的指引。",
                    tags: ["第十三章", "职场心态", "修身"],
                    likes: 56,
                    comments: 23
                }
            ],
            popular: [
                {
                    user: "郑强",
                    avatarId: 12,
                    time: "1周前",
                    isHot: true,
                    title: "AI时代重读《道德经》的意义",
                    content: "在人工智能飞速发展的今天，重读《道德经》不仅是为了怀古，更是为了寻找人类在技术浪潮中的定位。'人法地，地法天'的思想或许能为AI伦理提供新的视角。",
                    tags: ["AI伦理", "时代价值", "深度思考"],
                    likes: 245,
                    comments: 112
                },
                {
                    user: "孙梅",
                    avatarId: 13,
                    time: "2周前",
                    isHot: true,
                    title: "《道德经》是兵书吗？",
                    content: "有人说《道德经》是一部兵书，也有人说它是治国理政之书。'以正治国，以奇用兵，以无事取天下'，大家怎么理解这句话？",
                    tags: ["军事思想", "治国理政", "多维解读"],
                    likes: 189,
                    comments: 95
                }
            ],
            unanswered: [
                {
                    user: "冯杰",
                    avatarId: 14,
                    time: "3天前",
                    isUnanswered: true,
                    title: "第三章'虚其心，实其腹'的具体修行方法？",
                    content: "老子在第三章提到'虚其心，实其腹，弱其志，强其骨'。这里的'实其腹'是指吃饱饭吗？还是有某种气功修炼的含义？求高人指点。",
                    tags: ["第三章", "修行方法", "求教"],
                    likes: 8,
                    comments: 0
                },
                {
                    user: "韩梅",
                    avatarId: 15,
                    time: "4天前",
                    isUnanswered: true,
                    title: "为什么说'大器晚成'？",
                    content: "《道德经》第四十一章提到'大器晚成'（或作'大器免成'）。在快节奏的现代社会，我们是否还需要坚持这种'晚成'的心态？这与'出名要趁早'是否矛盾？",
                    tags: ["第四十一章", "人生观", "困惑"],
                    likes: 15,
                    comments: 1
                }
            ]
        };

        // 初始化加载更多功能
        function initLoadMoreFunctionality() {
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            if (!loadMoreBtn) return;
            
            loadMoreBtn.addEventListener('click', function() {
                // 获取当前活跃的标签页
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return;
                
                const tabId = activeTab.id;
                
                // 如果是"关注的人"标签页，这里暂不处理（因为示例中是空的）
                if (tabId === 'following') {
                    showNotification('暂无更多关注动态', 'info');
                    return;
                }
                
                // 获取对应的数据
                const posts = morePostsData[tabId];
                
                if (!posts || posts.length === 0) {
                    showNotification('没有更多内容了', 'info');
                    this.textContent = '没有更多内容了';
                    this.disabled = true;
                    return;
                }
                
                // 模拟加载延迟
                this.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>加载中...';
                this.disabled = true;
                
                setTimeout(() => {
                    // 添加帖子到页面
                    appendPosts(activeTab, posts);
                    
                    // 恢复按钮状态
                    this.innerHTML = '加载更多';
                    this.disabled = false;
                    
                    // 标记数据已加载（简单处理：清空对应数据防止重复加载）
                    // 实际项目中应该是分页加载
                    morePostsData[tabId] = [];
                    
                }, 800);
            });
        }
        
        // 追加帖子到列表
        function appendPosts(container, posts) {
            const listContainer = container.querySelector('.space-y-6') || container;
            
            posts.forEach(post => {
                // 构建标签HTML
                const tagsHTML = post.tags.map(tag => `<span class="tag">#${tag}</span>`).join('');
                
                // 构建特殊标记（热门/待解答）
                let badgeHTML = '';
                if (post.isHot) {
                    badgeHTML = '<span class="ml-2 px-2 py-1 bg-red-100 text-red-600 text-xs rounded-full">热门</span>';
                } else if (post.isUnanswered) {
                    badgeHTML = '<span class="ml-2 px-2 py-1 bg-orange-100 text-orange-600 text-xs rounded-full">待解答</span>';
                }
                
                const postHTML = `
                    <article class="post-card bg-white rounded-lg shadow-md p-6 fade-in-up" style="opacity: 0; transform: translateY(20px); transition: all 0.5s ease;">
                        <div class="flex items-start mb-4">
                            <img src="https://picsum.photos/id/${post.avatarId}/40/40" alt="用户头像" class="user-avatar mr-3">
                            <div class="flex-1">
                                <div class="flex items-center mb-1">
                                    <h3 class="font-medium text-dark mr-2">${post.user}</h3>
                                    <button class="follow-btn" data-username="${post.user}">
                                        <span>+ 关注</span>
                                    </button>
                                    <span class="text-sm text-gray-500">${post.time}</span>
                                    ${badgeHTML}
                                </div>
                                <h2 class="text-xl font-bold text-dark mb-2">${post.title}</h2>
                                <p class="text-gray-700 mb-4">
                                    ${post.content}
                                </p>
                                <div class="mb-4">
                                    ${tagsHTML}
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-4">
                                        <button class="reaction-btn">
                                            <i class="far fa-thumbs-up mr-1"></i>
                                            <span>${post.likes}</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-comment mr-1"></i>
                                            <span>${post.comments}</span>
                                        </button>
                                        <button class="reaction-btn">
                                            <i class="far fa-bookmark mr-1"></i>
                                            <span>收藏</span>
                                        </button>
                                    </div>
                                    <div class="share-container">
                                        <button class="reaction-btn share-btn">
                                            <i class="fas fa-share mr-1"></i>
                                            <span>分享</span>
                                        </button>
                                        <div class="share-dropdown">
                                            <button class="share-item" data-action="wechat">
                                                <i class="fab fa-weixin"></i> 微信
                                            </button>
                                            <button class="share-item" data-action="moments">
                                                <i class="fas fa-circle-notch"></i> 朋友圈
                                            </button>
                                            <button class="share-item" data-action="qq">
                                                <i class="fab fa-qq"></i> QQ
                                            </button>
                                            <button class="share-item" data-action="qzone">
                                                <i class="fas fa-star"></i> QQ空间
                                            </button>
                                            <div class="share-separator"></div>
                                            <button class="share-item" data-action="copy">
                                                <i class="fas fa-link"></i> 复制链接
                                            </button>
                                            <button class="share-item" data-action="feedback">
                                                <i class="fas fa-comment-alt"></i> 内容反馈
                                            </button>
                                            <button class="share-item" data-action="report">
                                                <i class="fas fa-exclamation-circle"></i> 举报
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>
                `;
                
                listContainer.insertAdjacentHTML('beforeend', postHTML);
            });
            
            // 触发简单的入场动画
            setTimeout(() => {
                const newPosts = listContainer.querySelectorAll('.post-card[style*="opacity: 0"]');
                newPosts.forEach(post => {
                    post.style.opacity = '1';
                    post.style.transform = 'translateY(0)';
                });
            }, 50);
            
            // 重新初始化交互功能
            initLikeFunctionality();
            initBookmarkFunctionality();
            initShareFunctionality();
            initFollowFunctionality();
        }

        // 初始化分享功能
        function initShareFunctionality() {
            // 获取所有分享按钮容器
            const shareContainers = document.querySelectorAll('.share-container');
            
            shareContainers.forEach(container => {
                if (container.dataset.initialized) return;
                container.dataset.initialized = 'true';
                
                const btn = container.querySelector('.share-btn');
                const dropdown = container.querySelector('.share-dropdown');
                
                // 点击按钮切换菜单
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    // 关闭其他打开的菜单
                    document.querySelectorAll('.share-container.active').forEach(c => {
                        if (c !== container) c.classList.remove('active');
                    });
                    
                    container.classList.toggle('active');
                });
                
                // 点击菜单项
                const items = dropdown.querySelectorAll('.share-item');
                items.forEach(item => {
                    item.addEventListener('click', function(e) {
                        e.stopPropagation();
                        const action = this.dataset.action;
                        const article = container.closest('article');
                        const postTitle = article ? article.querySelector('h2').textContent : '未知帖子';
                        
                        handleShareAction(action, postTitle);
                        container.classList.remove('active');
                    });
                });
            });
            
            // 点击页面其他地方关闭菜单
            document.addEventListener('click', function() {
                document.querySelectorAll('.share-container.active').forEach(c => {
                    c.classList.remove('active');
                });
            });
        }
        
        // 处理分享动作
        function handleShareAction(action, title) {
            switch(action) {
                case 'wechat':
                    showNotification('请使用微信扫一扫（模拟）', 'info');
                    break;
                case 'moments':
                    showNotification('已生成朋友圈海报（模拟）', 'success');
                    break;
                case 'qq':
                    showNotification('正在唤起QQ分享...', 'info');
                    break;
                case 'qzone':
                    showNotification('正在分享到QQ空间...', 'info');
                    break;
                case 'copy':
                    // 模拟复制链接
                    const dummyLink = `https://daodejing.ai/post/${Math.random().toString(36).substr(2, 9)}`;
                    navigator.clipboard.writeText(dummyLink).then(() => {
                        showNotification('链接已复制到剪贴板', 'success');
                    }).catch(() => {
                        showNotification('复制失败，请手动复制', 'info');
                    });
                    break;
                case 'feedback':
                    showNotification('感谢您的反馈，我们会尽快处理', 'success');
                    break;
                case 'report':
                    // 简单的举报确认
                    if(confirm(`确定要举报帖子 "${title}" 吗？`)) {
                        setTimeout(() => {
                            showNotification('举报已提交，管理员将进行审核', 'success');
                        }, 500);
                    }
                    break;
            }
        }

        // 初始化收藏功能
        function initBookmarkFunctionality() {
            // 获取所有收藏按钮
            const bookmarkButtons = document.querySelectorAll('.reaction-btn:has(.fa-bookmark)');
            
            // 为每个收藏按钮添加点击事件
            bookmarkButtons.forEach(button => {
                // 防止重复初始化
                if (button.dataset.initialized) return;
                button.dataset.initialized = 'true';

                // 加载保存的收藏状态
                const postId = button.closest('article').dataset.postId || generatePostId(button);
                button.closest('article').dataset.postId = postId;
                
                // 恢复收藏状态
                if (isBookmarked(postId)) {
                    button.classList.add('active');
                    button.querySelector('i').classList.remove('far');
                    button.querySelector('i').classList.add('fas');
                    button.querySelector('span').textContent = '已收藏';
                }
                
                // 添加点击事件
                button.addEventListener('click', function() {
                    toggleBookmark(this);
                });
            });
        }
        
        // 生成帖子ID（基于标题和用户）
        function generatePostId(button) {
            const article = button.closest('article');
            const title = article.querySelector('h2').textContent.trim();
            const user = article.querySelector('h3').textContent.trim();
            // 移除可能破坏CSS选择器的特殊字符（如引号、括号等）
            return `${user}-${title}`
                .replace(/[\\"'()[\]{}<>]/g, '') // 移除特殊字符
                .replace(/\s+/g, '-')             // 空格转连字符
                .toLowerCase();
        }
        
        // 检查帖子是否已收藏
        function isBookmarked(postId) {
            const bookmarks = JSON.parse(localStorage.getItem('communityBookmarks') || '[]');
            return bookmarks.includes(postId);
        }
        
        // 切换收藏状态
        function toggleBookmark(button) {
            const postId = button.closest('article').dataset.postId;
            const bookmarks = JSON.parse(localStorage.getItem('communityBookmarks') || '[]');
            
            // 找出页面上所有该帖子的实例（包括最新发布、热门讨论、收藏夹中的副本）
            const allInstances = document.querySelectorAll(`article[data-post-id="${postId}"]`);

            if (isBookmarked(postId)) {
                // 取消收藏
                const index = bookmarks.indexOf(postId);
                if (index > -1) {
                    bookmarks.splice(index, 1);
                }
                
                // 同步更新所有实例的按钮状态
                allInstances.forEach(article => {
                    const btn = article.querySelector('.reaction-btn:has(.fa-bookmark)');
                    if (btn) {
                        btn.classList.remove('active');
                        btn.querySelector('i').classList.remove('fas');
                        btn.querySelector('i').classList.add('far');
                        btn.querySelector('span').textContent = '收藏';
                    }
                });
                
                showNotification('已取消收藏', 'info');

                // 如果在收藏页，移除该帖子
                const activeTab = document.querySelector('.tab-content.active');
                if (activeTab && activeTab.id === 'favorites') {
                    // 在收藏页操作时，移除对应的卡片
                    // 注意：这里我们只移除当前被点击的卡片，或者是收藏页中的那个实例
                    // 如果是在其他页操作取消收藏，切换回收藏页时loadFavoritesContent会重新渲染，所以不用担心
                    // 但如果是在收藏页操作，需要有动画效果
                    
                    // 找到收藏页中的那个实例
                    const favoritesCard = document.querySelector(`#favorites article[data-post-id="${postId}"]`);
                    if (favoritesCard) {
                        favoritesCard.style.transition = 'all 0.3s ease';
                        favoritesCard.style.opacity = '0';
                        favoritesCard.style.transform = 'translateY(20px)';
                        setTimeout(() => {
                            favoritesCard.remove();
                            const favoritesContainer = document.querySelector('#favorites .space-y-6');
                            if (favoritesContainer && favoritesContainer.children.length === 0) {
                                loadFavoritesContent();
                            }
                        }, 300);
                    }
                }
            } else {
                // 添加收藏
                bookmarks.push(postId);
                
                // 同步更新所有实例的按钮状态
                allInstances.forEach(article => {
                    const btn = article.querySelector('.reaction-btn:has(.fa-bookmark)');
                    if (btn) {
                        btn.classList.add('active');
                        btn.querySelector('i').classList.remove('far');
                        btn.querySelector('i').classList.add('fas');
                        btn.querySelector('span').textContent = '已收藏';
                    }
                });
                
                showNotification('收藏成功', 'success');
            }
            
            // 保存到本地存储
            localStorage.setItem('communityBookmarks', JSON.stringify(bookmarks));
        }
        
        // 显示通知
        function showNotification(message, type = 'success') {
            // 创建通知元素
            const notification = document.createElement('div');
            notification.className = `fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-300 translate-y-0 opacity-0 ${
                type === 'success' ? 'bg-green-500 text-white' : 'bg-blue-500 text-white'
            }`;
            notification.textContent = message;
            
            // 添加到页面
            document.body.appendChild(notification);
            
            // 显示通知
            setTimeout(() => {
                notification.classList.remove('opacity-0', 'translate-y-0');
                notification.classList.add('opacity-100', 'translate-y-0');
            }, 10);
            
            // 3秒后隐藏通知
            setTimeout(() => {
                notification.classList.remove('opacity-100');
                notification.classList.add('opacity-0', 'translate-y-4');
                
                // 移除通知元素
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
        

        // 初始化标签切换功能
        function initTabSwitching() {
            const tabButtons = document.querySelectorAll('.tab-nav button');
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // 移除所有标签的活跃状态
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // 添加当前标签的活跃状态
                    this.classList.add('active');
                    
                    // 隐藏所有内容
                    const tabContents = document.querySelectorAll('.tab-content');
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // 显示对应内容
                    const tabId = this.dataset.tab;
                    document.getElementById(tabId).classList.add('active');

                    // 如果是收藏标签，加载收藏内容
                    if (tabId === 'favorites') {
                        loadFavoritesContent();
                    } else if (tabId === 'following') {
                        loadFollowingContent();
                    }

                    // 重置加载更多按钮状态
                    if (loadMoreBtn) {
                        // 检查该标签页是否有更多数据
                        // 收藏页默认没有更多按钮（或者是隐藏的）
                        if (tabId === 'favorites' || tabId === 'following') {
                             loadMoreBtn.style.display = 'none';
                        } else {
                             loadMoreBtn.style.display = 'inline-block';
                             const posts = morePostsData[tabId];
                             if (posts && posts.length > 0) {
                                 loadMoreBtn.textContent = '加载更多';
                                 loadMoreBtn.disabled = false;
                             } else {
                                 loadMoreBtn.textContent = '没有更多内容了';
                                 loadMoreBtn.disabled = true;
                             }
                        }
                    }
                });
            });
        }

        // 加载收藏内容
        function loadFavoritesContent() {
            const favoritesContainer = document.querySelector('#favorites .space-y-6');
            favoritesContainer.innerHTML = '';
            
            const bookmarks = JSON.parse(localStorage.getItem('communityBookmarks') || '[]');
            
            if (bookmarks.length === 0) {
                favoritesContainer.innerHTML = `
                    <div class="text-center py-12">
                        <i class="far fa-bookmark text-4xl text-gray-300 mb-4"></i>
                        <p class="text-gray-500">您还没有收藏任何帖子</p>
                    </div>
                `;
                return;
            }
            
            let foundCount = 0;
            
            bookmarks.forEach(id => {
                // 查找所有文章，排除收藏夹内的（虽然此时收藏夹已清空，但为了保险）
                // 使用属性选择器查找
                const sourcePost = document.querySelector(`article.post-card[data-post-id="${id}"]`);
                
                if (sourcePost) {
                    const clone = sourcePost.cloneNode(true);
                    // 确保可见性
                    clone.style.opacity = '1';
                    clone.style.transform = 'translateY(0)';
                    
                    // 添加到收藏夹
                    favoritesContainer.appendChild(clone);
                    foundCount++;
                }
            });
            
            if (foundCount === 0) {
                 favoritesContainer.innerHTML = `
                    <div class="text-center py-12">
                        <i class="far fa-folder-open text-4xl text-gray-300 mb-4"></i>
                        <p class="text-gray-500">找不到已收藏的帖子（可能是动态加载的内容已失效）</p>
                    </div>
                `;
            } else {
                // 重置克隆元素的初始化状态，以便重新绑定事件
                const newButtons = favoritesContainer.querySelectorAll('.reaction-btn, .follow-btn');
                newButtons.forEach(btn => delete btn.dataset.initialized);
                
                const newShareContainers = favoritesContainer.querySelectorAll('.share-container');
                newShareContainers.forEach(container => delete container.dataset.initialized);
                
                // 重新初始化事件监听
                initLikeFunctionality();
                initBookmarkFunctionality();
                initShareFunctionality();
                initFollowFunctionality();
            }
        }
        
        // 初始化点赞功能
        function initLikeFunctionality() {
            // 获取所有点赞按钮
            const likeButtons = document.querySelectorAll('.reaction-btn:has(.fa-thumbs-up)');
            
            // 为每个点赞按钮添加点击事件
            likeButtons.forEach(button => {
                // 防止重复初始化
                if (button.dataset.initialized) return;
                button.dataset.initialized = 'true';

                // 加载保存的点赞状态
                const postId = button.closest('article').dataset.postId || generatePostId(button);
                button.closest('article').dataset.postId = postId;
                
                // 恢复点赞状态
                if (isLiked(postId)) {
                    button.classList.add('active');
                    button.querySelector('i').classList.remove('far');
                    button.querySelector('i').classList.add('fas');
                }
                
                // 添加点击事件
                button.addEventListener('click', function() {
                    toggleLike(this);
                });
            });
        }
        
        // 检查帖子是否已点赞
        function isLiked(postId) {
            const likes = JSON.parse(localStorage.getItem('communityLikes') || '[]');
            return likes.includes(postId);
        }
        
        // 切换点赞状态
        function toggleLike(button) {
            const postId = button.closest('article').dataset.postId;
            const likes = JSON.parse(localStorage.getItem('communityLikes') || '[]');
            const countSpan = button.querySelector('span');
            let count = parseInt(countSpan.textContent);
            
            if (isLiked(postId)) {
                // 取消点赞
                const index = likes.indexOf(postId);
                if (index > -1) {
                    likes.splice(index, 1);
                }
                button.classList.remove('active');
                button.querySelector('i').classList.remove('fas');
                button.querySelector('i').classList.add('far');
                count--;
                showNotification('已取消点赞', 'info');
            } else {
                // 添加点赞
                likes.push(postId);
                button.classList.add('active');
                button.querySelector('i').classList.remove('far');
                button.querySelector('i').classList.add('fas');
                count++;
                showNotification('点赞成功', 'success');
            }
            
            // 更新点赞数
            countSpan.textContent = count;
            
            // 保存到本地存储
            localStorage.setItem('communityLikes', JSON.stringify(likes));
        }
        
        // 初始化表单功能
        function initFormFunctionality() {
            const saveDraftBtn = document.getElementById('saveDraftBtn');
            const createPostForm = document.getElementById('createPostForm');
            const draftBoxBtn = document.getElementById('draftBoxBtn');
            const clearAllDraftsBtn = document.getElementById('clearAllDrafts');
            
            // 加载保存的草稿
            loadDraft();
            
            // 保存草稿按钮点击事件
            saveDraftBtn.addEventListener('click', function() {
                saveDraft();
                // 保存后更新草稿箱
                updateDraftBox();
            });
            
            // 草稿箱按钮点击事件
            if (draftBoxBtn) {
                draftBoxBtn.addEventListener('click', function() {
                    toggleDraftBox();
                    // 点击时更新草稿箱
                    updateDraftBox();
                });
            }
            
            // 清空草稿箱按钮点击事件
            if (clearAllDraftsBtn) {
                clearAllDraftsBtn.addEventListener('click', function() {
                    clearAllDrafts();
                });
            }
            
            // 发布帖子表单提交事件
            createPostForm.addEventListener('submit', function(e) {
                e.preventDefault();
                publishPost();
            });
            
            // 点击页面其他地方关闭草稿箱
            document.addEventListener('click', function(e) {
                const draftBox = document.getElementById('draftBox');
                const draftBoxBtn = document.getElementById('draftBoxBtn');
                
                if (draftBox && !draftBox.contains(e.target) && e.target !== draftBoxBtn) {
                    draftBox.classList.add('hidden');
                }
            });
        }
        
        // 保存草稿
        function saveDraft() {
            const title = document.getElementById('postTitle').value;
            const content = document.getElementById('postContent').value;
            const tags = document.getElementById('postTags').value;
            
            if (!title && !content && !tags) {
                showNotification('请输入内容后再保存草稿', 'info');
                return;
            }
            
            const draft = {
                id: Date.now().toString(),
                title,
                content,
                tags,
                savedAt: new Date().toISOString()
            };
            
            // 获取现有草稿列表
            const drafts = JSON.parse(localStorage.getItem('communityDrafts') || '[]');
            
            // 检查是否已存在草稿（如果有相同内容）
            const existingIndex = drafts.findIndex(d => d.id === draft.id);
            
            if (existingIndex > -1) {
                // 更新现有草稿
                drafts[existingIndex] = draft;
            } else {
                // 添加新草稿
                drafts.push(draft);
            }
            
            localStorage.setItem('communityDrafts', JSON.stringify(drafts));
            showNotification('草稿保存成功', 'success');
        }
        
        // 加载草稿
        function loadDraft(draftId = null) {
            let draft = null;
            
            if (draftId) {
                // 加载指定草稿
                const drafts = JSON.parse(localStorage.getItem('communityDrafts') || '[]');
                draft = drafts.find(d => d.id === draftId);
            } else {
                // 加载最新草稿
                const drafts = JSON.parse(localStorage.getItem('communityDrafts') || '[]');
                if (drafts.length > 0) {
                    // 按保存时间排序，取最新的
                    drafts.sort((a, b) => new Date(b.savedAt) - new Date(a.savedAt));
                    draft = drafts[0];
                }
            }
            
            if (draft) {
                document.getElementById('postTitle').value = draft.title || '';
                document.getElementById('postContent').value = draft.content || '';
                document.getElementById('postTags').value = draft.tags || '';
                
                // 显示草稿加载通知
                showNotification('已加载草稿', 'info');
            }
        }
        
        // 发布帖子
        function publishPost() {
            const title = document.getElementById('postTitle').value;
            const content = document.getElementById('postContent').value;
            const tags = document.getElementById('postTags').value;
            
            // 表单验证
            if (!title.trim()) {
                showNotification('请输入帖子标题', 'info');
                return;
            }
            
            if (!content.trim()) {
                showNotification('请输入帖子内容', 'info');
                return;
            }
            
            // 模拟发布过程
            showNotification('帖子发布中...', 'info');
            
            // 模拟网络请求延迟
            setTimeout(() => {
                // 发布成功
                showNotification('帖子发布成功', 'success');
                
                // 将新帖子添加到页面
                addNewPost(title, content, tags);
                
                // 清空表单
                document.getElementById('postTitle').value = '';
                document.getElementById('postContent').value = '';
                document.getElementById('postTags').value = '';
                
                // 清除所有草稿
                localStorage.removeItem('communityDrafts');
                
                // 更新草稿箱显示
                updateDraftBox();
                
                // 这里可以添加跳转到帖子详情页或刷新帖子列表的逻辑
            }, 1000);
        }
        
        // 添加新帖子到页面
        function addNewPost(title, content, tags) {
            const postList = document.querySelector('#latest .space-y-6');
            
            // 创建标签HTML
            const tagsArray = tags.split(/\s+/).filter(tag => tag.trim());
            const tagsHTML = tagsArray.map(tag => `<span class="tag">#${tag}</span>`).join('');
            
            // 创建新帖子HTML
            const newPostHTML = `
                <article class="post-card bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-start mb-4">
                        <img src="https://picsum.photos/id/${Math.floor(Math.random() * 100)}/40/40" alt="用户头像" class="user-avatar mr-3">
                        <div class="flex-1">
                            <div class="flex items-center mb-1">
                                <h3 class="font-medium text-dark mr-2">当前用户</h3>
                                <button class="follow-btn" data-username="当前用户">
                                    <span>+ 关注</span>
                                </button>
                                <span class="text-sm text-gray-500">刚刚</span>
                            </div>
                            <h2 class="text-xl font-bold text-dark mb-2">${title}</h2>
                            <p class="text-gray-700 mb-4">
                                ${content}
                            </p>
                            <div class="mb-4">
                                ${tagsHTML}
                            </div>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <button class="reaction-btn">
                                        <i class="far fa-thumbs-up mr-1"></i>
                                        <span>0</span>
                                    </button>
                                    <button class="reaction-btn">
                                        <i class="far fa-comment mr-1"></i>
                                        <span>0</span>
                                    </button>
                                    <button class="reaction-btn">
                                        <i class="far fa-bookmark mr-1"></i>
                                        <span>收藏</span>
                                    </button>
                                </div>
                                    <div class="share-container">
                                        <button class="reaction-btn share-btn">
                                            <i class="fas fa-share mr-1"></i>
                                            <span>分享</span>
                                        </button>
                                        <div class="share-dropdown">
                                            <button class="share-item" data-action="wechat">
                                                <i class="fab fa-weixin"></i> 微信
                                            </button>
                                            <button class="share-item" data-action="moments">
                                                <i class="fas fa-circle-notch"></i> 朋友圈
                                            </button>
                                            <button class="share-item" data-action="qq">
                                                <i class="fab fa-qq"></i> QQ
                                            </button>
                                            <button class="share-item" data-action="qzone">
                                                <i class="fas fa-star"></i> QQ空间
                                            </button>
                                            <div class="share-separator"></div>
                                            <button class="share-item" data-action="copy">
                                                <i class="fas fa-link"></i> 复制链接
                                            </button>
                                            <button class="share-item" data-action="feedback">
                                                <i class="fas fa-comment-alt"></i> 内容反馈
                                            </button>
                                            <button class="share-item" data-action="report">
                                                <i class="fas fa-exclamation-circle"></i> 举报
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>
                `;
            
                // 将新帖子添加到列表顶部
            postList.insertAdjacentHTML('afterbegin', newPostHTML);
            
            // 重新初始化新帖子的交互功能
            initLikeFunctionality();
            initBookmarkFunctionality();
            initShareFunctionality();
            initFollowFunctionality();
        }
        
        // 切换草稿箱显示/隐藏
        function toggleDraftBox() {
            const draftBox = document.getElementById('draftBox');
            if (draftBox) {
                draftBox.classList.toggle('hidden');
            }
        }
        
        // 更新草稿箱内容
        function updateDraftBox() {
            const draftList = document.getElementById('draftList');
            if (!draftList) return;
            
            // 获取草稿列表
            const drafts = JSON.parse(localStorage.getItem('communityDrafts') || '[]');
            
            // 按保存时间排序（最新的在前）
            drafts.sort((a, b) => new Date(b.savedAt) - new Date(a.savedAt));
            
            if (drafts.length === 0) {
                // 无草稿时显示提示
                draftList.innerHTML = '<div class="no-drafts">暂无草稿</div>';
                return;
            }
            
            // 生成草稿列表HTML
            const draftItemsHTML = drafts.map(draft => {
                // 格式化保存时间
                const savedTime = new Date(draft.savedAt);
                const formattedTime = `${savedTime.getFullYear()}-${String(savedTime.getMonth() + 1).padStart(2, '0')}-${String(savedTime.getDate()).padStart(2, '0')} ${String(savedTime.getHours()).padStart(2, '0')}:${String(savedTime.getMinutes()).padStart(2, '0')}`;
                
                // 生成草稿标题预览
                const draftTitle = draft.title || '无标题';
                
                return `
                    <div class="draft-item" data-draft-id="${draft.id}">
                        <div class="draft-item-title">${draftTitle}</div>
                        <div class="draft-item-meta">
                            <span>${formattedTime}</span>
                            <div class="draft-item-actions">
                                <button class="draft-item-delete" onclick="deleteDraft('${draft.id}')">删除</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            // 更新草稿列表
            draftList.innerHTML = draftItemsHTML;
            
            // 为草稿项添加点击事件（加载草稿）
            const draftItems = document.querySelectorAll('.draft-item');
            draftItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    // 避免点击删除按钮时触发加载
                    if (!e.target.classList.contains('draft-item-delete')) {
                        const draftId = this.dataset.draftId;
                        loadDraft(draftId);
                        // 加载后关闭草稿箱
                        document.getElementById('draftBox').classList.add('hidden');
                    }
                });
            });
        }
        
        // 删除指定草稿
        function deleteDraft(draftId) {
            // 获取现有草稿列表
            const drafts = JSON.parse(localStorage.getItem('communityDrafts') || '[]');
            
            // 过滤掉要删除的草稿
            const updatedDrafts = drafts.filter(draft => draft.id !== draftId);
            
            // 保存更新后的草稿列表
            localStorage.setItem('communityDrafts', JSON.stringify(updatedDrafts));
            
            // 更新草稿箱显示
            updateDraftBox();
            
            // 显示删除成功通知
            showNotification('草稿删除成功', 'success');
        }
        
        // 清空所有草稿
        function clearAllDrafts() {
            // 确认清空
            if (confirm('确定要清空所有草稿吗？此操作不可恢复。')) {
                // 清除本地存储中的草稿
                localStorage.removeItem('communityDrafts');
                
                // 更新草稿箱显示
                updateDraftBox();
                
                // 显示清空成功通知
                showNotification('草稿箱已清空', 'success');
            }
        }

        // 初始化关注功能
        function initFollowFunctionality() {
            // 获取所有关注按钮
            const followButtons = document.querySelectorAll('.follow-btn');
            
            followButtons.forEach(button => {
                // 防止重复初始化
                if (button.dataset.initialized) return;
                button.dataset.initialized = 'true';
                
                const username = button.dataset.username;
                if (!username) return;
                
                // 恢复关注状态
                if (isFollowed(username)) {
                    button.classList.add('active');
                    button.querySelector('span').textContent = '已关注';
                }
                
                // 添加点击事件
                button.addEventListener('click', function(e) {
                    e.stopPropagation();
                    toggleFollow(this);
                });
            });
        }
        
        // 检查用户是否已关注
        function isFollowed(username) {
            const followedUsers = JSON.parse(localStorage.getItem('communityFollowedUsers') || '[]');
            return followedUsers.includes(username);
        }
        
        // 切换关注状态
        function toggleFollow(button) {
            const username = button.dataset.username;
            if (!username) return;
            
            let followedUsers = JSON.parse(localStorage.getItem('communityFollowedUsers') || '[]');
            const isFollowing = followedUsers.includes(username);
            
            if (isFollowing) {
                // 取消关注
                followedUsers = followedUsers.filter(u => u !== username);
                showNotification(`已取消关注 ${username}`, 'info');
            } else {
                // 添加关注
                followedUsers.push(username);
                showNotification(`已关注 ${username}`, 'success');
            }
            
            // 保存状态
            localStorage.setItem('communityFollowedUsers', JSON.stringify(followedUsers));
            
            // 更新页面上所有该用户的关注按钮状态
            const allButtons = document.querySelectorAll(`.follow-btn[data-username="${username}"]`);
            allButtons.forEach(btn => {
                if (isFollowing) {
                    btn.classList.remove('active');
                    btn.querySelector('span').textContent = '+ 关注';
                } else {
                    btn.classList.add('active');
                    btn.querySelector('span').textContent = '已关注';
                }
            });
            
            // 如果在关注页面，刷新内容
            const followingTab = document.getElementById('following');
            if (followingTab && followingTab.classList.contains('active')) {
                loadFollowingContent();
            }
        }
        
        // 加载关注页内容
        function loadFollowingContent() {
            const followingContainer = document.querySelector('#following .space-y-6');
            if (!followingContainer) return;
            
            followingContainer.innerHTML = '';
            
            const followedUsers = JSON.parse(localStorage.getItem('communityFollowedUsers') || '[]');
            
            if (followedUsers.length === 0) {
                followingContainer.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-user-friends text-4xl text-gray-300 mb-4"></i>
                        <p class="text-gray-500">您还没有关注任何人</p>
                    </div>
                `;
                return;
            }
            
            // 显示关注的用户列表
            const gridHTML = `
                <div class="followed-users-grid">
                    ${followedUsers.map(username => `
                        <div class="followed-user-card">
                            <img src="https://picsum.photos/seed/${username}/200" alt="${username}" class="followed-user-avatar">
                            <div class="followed-user-name">${username}</div>
                            <div class="followed-user-bio">道法自然，无为而治。热爱传统文化，探索生命智慧。</div>
                            <button class="follow-btn active mt-2" data-username="${username}">
                                <span>已关注</span>
                            </button>
                        </div>
                    `).join('')}
                </div>
                <div class="border-t border-gray-200 my-6"></div>
                <h3 class="text-lg font-bold text-dark mb-4">关注用户的动态</h3>
            `;
            
            followingContainer.innerHTML = gridHTML;
            
            // 加载关注用户的帖子（从页面上现有的帖子中筛选）
            // 这里为了演示，我们克隆页面上已有的帖子
            // 实际应用中应该从后端获取
            
            let foundPosts = false;
            
            // 获取所有文章
            const allPosts = document.querySelectorAll('article.post-card');
            
            allPosts.forEach(post => {
                // 排除克隆的帖子（如果在关注页内）
                if (post.closest('#following')) return;
                
                const postUsername = post.querySelector('h3.font-medium')?.textContent;
                if (followedUsers.includes(postUsername)) {
                    const clone = post.cloneNode(true);
                    // 移除原有的隐藏样式
                    clone.style.opacity = '1';
                    clone.style.transform = 'translateY(0)';
                    
                    followingContainer.appendChild(clone);
                    foundPosts = true;
                }
            });
            
            if (!foundPosts) {
                followingContainer.insertAdjacentHTML('beforeend', `
                    <div class="text-center py-8">
                        <p class="text-gray-500">关注的用户暂无最新动态</p>
                    </div>
                `);
            } else {
                // 重置克隆元素的初始化状态
                const newButtons = followingContainer.querySelectorAll('.reaction-btn, .follow-btn');
                newButtons.forEach(btn => delete btn.dataset.initialized);
                
                // 重新初始化事件监听
                initLikeFunctionality();
                initBookmarkFunctionality();
                initShareFunctionality();
                initFollowFunctionality();
            }
        }

        
        // 初始化搜索功能
        function initSearchFunctionality() {
            const searchInput = document.getElementById('searchInput');
            const searchBtn = document.getElementById('searchBtn');
            
            if (!searchInput || !searchBtn) return;
            
            // 执行搜索
            function performSearch() {
                const query = searchInput.value.trim().toLowerCase();
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return;
                
                // 如果是在"关注的人"或"我的收藏"页面，可能没有post-card，或者结构不同
                // 这里主要针对帖子列表进行搜索
                const posts = activeTab.querySelectorAll('.post-card');
                let hasResults = false;
                
                posts.forEach(post => {
                    const title = post.querySelector('h2')?.textContent.toLowerCase() || '';
                    const content = post.querySelector('p')?.textContent.toLowerCase() || '';
                    const tags = Array.from(post.querySelectorAll('.tag')).map(t => t.textContent.toLowerCase()).join(' ');
                    const user = post.querySelector('h3')?.textContent.toLowerCase() || '';
                    
                    if (query === '' || title.includes(query) || content.includes(query) || tags.includes(query) || user.includes(query)) {
                        post.style.display = 'block';
                        post.style.opacity = '1'; 
                        hasResults = true;
                    } else {
                        post.style.display = 'none';
                    }
                });
                
                // 处理无结果提示
                let noResultsMsg = activeTab.querySelector('.no-results-msg');
                if (!hasResults && query !== '') {
                    if (!noResultsMsg) {
                        noResultsMsg = document.createElement('div');
                        noResultsMsg.className = 'no-results-msg text-center py-12 text-gray-500';
                        noResultsMsg.innerHTML = '<i class="fas fa-search mb-4 text-4xl text-gray-300"></i><p>没有找到相关帖子</p>';
                        activeTab.appendChild(noResultsMsg);
                    }
                } else if (noResultsMsg) {
                    noResultsMsg.remove();
                }
            }
            
            // 绑定事件
            searchBtn.addEventListener('click', performSearch);
            searchInput.addEventListener('keyup', (e) => {
                if (e.key === 'Enter') {
                    performSearch();
                } else if (searchInput.value === '') {
                    performSearch(); // 清空时恢复显示
                }
            });
        }
    </script>




</body>
</html>